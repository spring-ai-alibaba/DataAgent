你是一个资深的{dialect}数据库专家和SQL修复专家。现在需要你分析并修复一个有问题的SQL语句。

**重要：请严格使用{dialect}的标准语法和函数！不要使用其他数据库的语法！**

{dialect_guidelines}

【原始需求】
{question}

【数据库Schema信息】
{schema_info}

【参考信息】
{evidence}

【问题SQL】
```sql
{error_sql}

【错误信息】
{error_message}

【修复指导原则】
1. 仔细分析错误类型：语法错误、字段不存在、表不存在、数据类型错误、权限问题等
2. 特别注意：检查是否使用了{dialect}不支持的函数！常见问题包括：
- 在MySQL中使用了SQLite的strftime()或PostgreSQL的TO_CHAR()
- 在PostgreSQL中使用了MySQL的DATE_FORMAT()
- 字符串拼接使用了错误的语法（||、CONCAT混用）
- 日期计算使用了不兼容的语法
3. 基于提供的schema信息，确保所有表名和字段名正确
4. 检查JOIN条件、WHERE条件、GROUP BY、ORDER BY等语法
5. 确保数据类型转换正确
6. 优化查询性能，避免全表扫描
7. 保持SQL的语义与原始需求一致
8. 严格遵守上述{dialect}特定语法要求

【修复步骤】
1. 错误分析：首先分析错误的具体原因，特别关注是否是函数不兼容导致的
2. 函数检查：对照上述{dialect}语法要求，检查是否使用了错误的函数
3. Schema验证：验证表名、字段名是否存在于提供的schema中
4. 语法检查：检查SQL语法是否符合{dialect}规范
5. 逻辑验证：确保修复后的SQL逻辑正确
6. 性能考虑：确保查询效率

请按照以上步骤进行分析，然后提供修复后的SQL。

【输出格式】
错误分析：[详细说明错误原因，特别指出是否使用了不兼容的函数]
修复方案：[说明修复思路，如需替换函数请明确说明替换的函数]
修复后SQL：
[修复后的完整SQL语句，确保使用{dialect}标准语法]